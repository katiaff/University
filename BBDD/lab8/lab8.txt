CREATE TABLE alumno(
dnia VARCHAR(100) NOT NULL,
noma VARCHAR (100),
apella VARCHAR (200),
domicilioa VARCHAR (300),
f_nacimiento DATE,
f_ingreso DATE,
CONSTRAINT alumno_pk PRIMARY KEY (dnia)
);

CREATE TABLE profesor(
dnip VARCHAR(100) NOT NULL,
nombrep VARCHAR(100),
apellidop VARCHAR(200),
domiciliop VARCHAR(300),
CONSTRAINT profesor_pk PRIMARY KEY (dnip)
);

CREATE TABLE carrera(
codcarr VARCHAR(100) NOT NULL,
nombrec VARCHAR(100),
duracion DECIMAL,
CONSTRAINT carrera_pk PRIMARY KEY(codcarr)
);


CREATE TABLE asignatura(
codasig VARCHAR(100) NOT NULL,
codcarr VARCHAR(100) NOT NULL,
nomasig VARCHAR(100),
curso VARCHAR(100),
creditos DECIMAL,
tipo VARCHAR(100) NOT NULL,
CONSTRAINT asignatura_pk PRIMARY KEY (codasig),
CONSTRAINT asignatura_carrera_fk FOREIGN KEY (codcarr) REFERENCES carrera(codcarr)
CONSTRAINT asignatura_nomasig_uk UNIQUE (nomasig),
CONSTRAINT asignatura_tipo_ck CHECK (tipo IN ('obligatoria', 'optativa', 'libre configuraci√≥n'))
);

CREATE TABLE imparte(
codasig VARCHAR(100) NOT NULL,
dnip VARCHAR(100) NOT NULL, 
CONSTRAINT imparte_pk PRIMARY KEY (codasig, dnip),
CONSTRAINT imparte_asig_fk FOREIGN KEY (codasig) REFERENCES asignatura(codasig),
CONSTRAINT imparte_prof_fk FOREIGN KEY (dnip) REFERENCES profesor(dnip)
);

CREATE TABLE califica1(
codasig VARCHAR(100) NOT NULL,
dnia VARCHAR(100) NOT NULL,
dnip VARCHAR(100) NOT NULL,
nota DECIMAL,
fecha_calificacion DATE,
CONSTRAINT califica1_pk PRIMARY KEY (codasig, dnia),
CONSTRAINT califica1_alumno_fk FOREIGN KEY(dnia) REFERENCES alumno(dnia),
CONSTRAINT califica1_asign_fk FOREIGN KEY(codasig) REFERENCES asignatura(codasig),
CONSTRAINT califica1_prof_fk FOREIGN KEY(dnip) REFERENCES profesor(dnip),
CONSTRAINT nota1_ck CHECK (nota between 0 and 10)
);

CREATE TABLE califica2(
dnia VARCHAR(100) NOT NULL,
dnip VARCHAR(100) NOT NULL,
codasig VARCHAR(100) NOT NULL,
nota DECIMAL,
fecha_calificacion DATE,
CONSTRAINT califica2_pk PRIMARY KEY (dnia, codasig, dnip),
CONSTRAINT califica2_alumno_fk FOREIGN KEY(dnia) REFERENCES alumno(dnia),
CONSTRAINT califica2_imparte_fk FOREIGN KEY(codasig, dnip) REFERENCES imparte(codasig, dnip),
CONSTRAINT califica2_alumno_asig_uk UNIQUE (dnia, codasig)
CONSTRAINT nota2_ck CHECK (nota between 0 and 10)
);



